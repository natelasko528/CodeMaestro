{"direction":"out","type":"STATUS","sessionId":"S-smoke3","payload":{"state":"IDLE","detail":"Session initialized"}}
{"direction":"in","type":"INIT","sessionId":"S-smoke3","payload":{"workspaceRoot":"/workspace","client":{"name":"smoke"}}}
{"direction":"out","type":"STATUS","sessionId":"S-smoke3","payload":{"state":"IDLE"}}
{"direction":"in","type":"USER_PROMPT","sessionId":"S-smoke3","payload":{"text":"smoke test"}}
{"direction":"out","type":"AGENT_MESSAGE","sessionId":"S-smoke3","payload":{"agent":"planner","phase":"planner","text":"1. Validate protocol + session boot\n2. Propose a deterministic multi-file edit for diff/apply\n3. Apply edits and record artifacts\n4. Run allowlisted tools (npm test) and capture output\n5. If green, mark DONE; otherwise iterate fixes\n\nUser request: smoke test"}}
{"direction":"out","type":"STATUS","sessionId":"S-smoke3","payload":{"state":"PLANNING"}}
{"direction":"out","type":"AGENT_MESSAGE","sessionId":"S-smoke3","payload":{"agent":"player","phase":"player","text":"I will propose a small, deterministic multi-file edit so you can preview and apply it."}}
{"direction":"out","type":"PROPOSE_EDIT","sessionId":"S-smoke3","payload":{"edits":[{"filePath":".codemaestro/scratch/S-smoke3/note-a.txt","newText":"CodeMaestro MVP\nSession: S-smoke3\nStable: aed68105fca432eca913ebca5ddccf4850028d98de3cce5d07fc4968410da736\n\nPrompt:\nsmoke test\n","summary":"Write scratch note A (deterministic multi-file apply)"},{"filePath":".codemaestro/scratch/S-smoke3/note-b.txt","newText":"This is the second file for multi-file apply.\nSession: S-smoke3\n","summary":"Write scratch note B (deterministic multi-file apply)"}]}}
{"direction":"out","type":"STATUS","sessionId":"S-smoke3","payload":{"state":"BUILDING"}}
{"direction":"out","type":"STATUS","sessionId":"S-smoke3","payload":{"state":"WAITING_FOR_APPLY"}}
{"direction":"in","type":"APPLY_EDIT_RESULT","sessionId":"S-smoke3","payload":{"applied":true,"fileResults":[]}}
{"direction":"out","type":"AGENT_MESSAGE","sessionId":"S-smoke3","payload":{"agent":"coach","phase":"coach","text":"Running allowlisted checks (npm test) before declaring DONE."}}
{"direction":"out","type":"STATUS","sessionId":"S-smoke3","payload":{"state":"VERIFYING"}}
{"direction":"out","type":"STATUS","sessionId":"S-smoke3","payload":{"state":"RUNNING_TOOL"}}
{"direction":"out","type":"TOOL_OUTPUT","sessionId":"S-smoke3","payload":{"command":"npm test","cwd":"/workspace/server","exitCode":0,"stdout":"\n> codemaestro-server@0.1.0 test\n> node --experimental-vm-modules node_modules/jest/bin/jest.js\n\n","stderr":"(node:7968) ExperimentalWarning: VM Modules is an experimental feature and might change at any time\n(Use `node --trace-warnings ...` to show where the warning was created)\nPASS src/__tests__/validate.test.ts\n(node:7969) ExperimentalWarning: VM Modules is an experimental feature and might change at any time\n(Use `node --trace-warnings ...` to show where the warning was created)\nPASS src/__tests__/sessionStore.test.ts\n(node:7975) ExperimentalWarning: VM Modules is an experimental feature and might change at any time\n(Use `node --trace-warnings ...` to show where the warning was created)\nPASS src/__tests__/allowlist.test.ts\nPASS src/__tests__/replay.test.ts\n\nTest Suites: 4 passed, 4 total\nTests:       7 passed, 7 total\nSnapshots:   0 total\nTime:        1.843 s, estimated 2 s\nRan all test suites.\n","truncated":{"stdout":false,"stderr":false}}}
{"direction":"out","type":"AGENT_MESSAGE","sessionId":"S-smoke3","payload":{"agent":"coach","phase":"coach","text":"PASS: checks are green. MVP loop satisfied for this session."}}
{"direction":"out","type":"STATUS","sessionId":"S-smoke3","payload":{"state":"DONE"}}
